# 收费调整说明

链路追踪Tracing Analysis于2020年10月11日0点对售价模型做出全新的升级，将以更优惠和更灵活的方式提供服务。您可以采用原先计费方案，直到资源包消耗完毕，也可以直接在界面上升级到新版本计费。



## 价格优势

链路追踪Tracing Analysis作为一款对标开源自建的产品，我们一直在追求更高的性价比。在大部分主流开源APM都仅存储7天数据的情况下，我们默认30天的存储显得不够灵活。

为了让您更好的按需使用，我们把计算和存储的价格进行了分割，同时提供实时调整存储时长的功能，让您可以按需调节自己数据的存储时长，从而更好的控制成本。

|客户类型|客户节点数|每日请求数|机器配置|开源成本（元/月）|链路追踪（元/月）|
|----|-----|-----|----|---------|---------|
|小型客户|80|2000万请求（请求复杂度：平均5个Span）|-   4台Elasticsearch（4CPU+16 G内存+1 T SSD硬盘）
-   4台Collector（4CPU+8 G内存）

|5836|764.8|
|中型客户|300|3亿请求（请求复杂度：平均7个Span）|-   8台Elasticsearch（8CPU+16 G内存+6 T SSD硬盘）
-   8台Collector（4CPU+8 G内存）

|22480|16065|
|大型客户|1000|10亿请求（请求复杂读：平均8个Span）|-   12台Elasticsearch（16CPU+64 G内存+21 T SSD硬盘）
-   16台Collector（4CPU+8 G内存）

|65088|64800|
|备注|无|参考Apache官方，1个Trace写入10 KB。|按照统一统计数据存15天，全量明细数据存7天计算。|-|按照存储的应用总请求数（每天请求数\*时长）计费，采用开源探针，其他组件由阿里云维护。|

## 新旧售价模型对比

-   旧版：按照请求次数收费，所有数据存储30天时间。
-   新版：将原来30天一口价细分为计算和存储费用，计费明细如下：

    -   链路计算费用：每上报百万条请求链路0.9元。
    -   链路存储费用：每存储百万条请求链路0.2元。
    -   统计指标存储费用：每存储百万条指标0.01元。
    **说明：**

    -   链路计算费用：根据实际上报的请求链路数决定，上报的链路请求会聚合生成统计指标（比如应用、接口、数据库的耗时、QPS、异常等）。您可以在控制台通过设置采样率调整上报量。

        示例：每天上报100万请求，收取1（1个百万条）\*0.9=0.9元。

    -   链路存储费用：存储1百万请求链路的费用。

        示例：平均每天上报100万请求链路，假设链路保存时长为15天，总的链路量为15（天）\* 1\(1个百万）=15个百万条，则每天的存储费用为总链路量15（百万）\*0.2（单价）=3元。

    -   统计指标存储费用：存储1百万指标的费用。指标（Metric）是统计数据，比如应用、接口、数据库的请求数据、响应时间、异常数。100万指标大致会产生100万的指标量。

        示例：平均每天产生100万指标量，假设指标保存时长为15天，总的指标量为15（天）\* 1（1个百万指标）=15个百万条，则每天的存储费用为总指标量15（百万）\* 0.01=0.15元，每天需要0.15元。

    -   请求链路的定义：在一个账号下TraceID相同的所有运动轨迹，视为一次请求。一个请求最多包含十个Span（Span的概念，请参考[基本概念](/cn.zh-CN/产品简介/基本概念.md)），超出的每个Span按照十分之一请求计费。每个Span最大不超过2KB，超出部分将会丢弃。
    -   计费方式：
        -   链路追踪是按天计费，每天0点计费前一天费用。
        -   链路计算费用只计算当天的流量。
        -   链路存储和指标存储是按存储量来计算，每天统计总的存储量，和存储天数有关。可以在[链路追踪Tracing Analysis控制台](https://tracing.console.aliyun.com/)集群配置页面调整适当的存储天数。

## 新旧售价模型对比案例

-   原先方案：全部数据存30天，400个百万请求收费5300元/天 。
-   新版方案：
    -   方案一：链路数据和统计指标数据全量存储30天。

        链路每天计算费用：400（400个百万请求）\* 0.9（百万计算单价）=360元/天

        链路每天存储费用：400（400个百万请求）\*30（天）\* 0.2（百万请求单价）=2,400元/天

        指标每天存储费用：400（400个百万请求大概产生400个百万Metric） \* 30（天）\* 0.01（百万指标单价）=120元/天

        总计：2880元/天

    -   方案二：链路数据存储7天，统计指标存储30天。

        链路每天计算费用：400（400个百万请求）\* 0.9（百万计算单价）=360元/天

        链路每天存储费用：400（400个百万请求）\*7（天）\* 0.2（百万请求单价）=560元/天

        指标每天存储费用：400（400个百万请求大概产生400个百万Metric） \*30（天）\* 0.01（百万指标单价）=120元/天

        总计：1040元/天


新版方案：链路数据存储7天，统计指标存储30天。

链路每天计算费用：10（10个百万请求）\*0.9（百万计算单价）=9元/天

链路每天存储费用：10（10个百万请求）\*7（天）\*0.2（百万请求单价）=14元/天

指标每天存储费用：10（10个百万请求大概产生10个百万Metric） \*30（天）\*0.01（百万指标单价）=3元/天

总计：26元/天

## 升级新版本计费

-   没有购买过资源包的客户，可以直接在[链路追踪Tracing Analysis控制台](https://tracing.console.aliyun.com/)的集群配置页面单击**保存**，即可完成升级。第二天可以在控制台首页右上角查看资源使用情况来预估新版的计费。
-   购买过资源包的客户，需要先对资源包进行退费（提交[工单](https://selfservice.console.aliyun.com/ticket/createIndex)申请资源包退费），然后才可以升级。
-   所有客户将在2021年04月01日0点后自动升级到新版本计费模型。

