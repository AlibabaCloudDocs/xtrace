# 分析调用链

通过调用链分析页面对应用的调用链信息进行分析后，您可对调用链信息进行条件过滤，还可查看应用拓扑、实时聚合链路表以及调用链瀑布图。

## 查看调用链信息

1.  登录[链路追踪Tracing Analysis控制台](https://tracing.console.aliyun.com/)。

2.  在左侧导航栏中单击**应用列表**，并在应用列表页面顶部选择地域，然后单击目标应用名称。

3.  在左侧导航栏中单击**调用链分析**，在调用链分析页面，可对调用链信息进行过滤，操作如下。

    单击顶部文本框，在弹出的筛选窗口中进行以下操作：

    -   在**耗时**参数后输入具体响应时间的最小值和最大值，可查询此耗时区间的调用链信息。
    -   勾选**异常**复选框，可查询有异常的调用链信息。
    -   添加**Span名称**、**机器/IP**或**标签**三个过滤条件。在添加过滤条件时，可添加多个**Span名称**、**机器/IP**或**标签**。
4.  单击**搜索**，可查看过滤后的调用链信息，包括：

    -   Span数量和异常数的时序曲线。
    -   Span耗时趋势曲线图。
    -   Span耗时分布图。
    -   Span列表和机器/IP列表。
    -   调用链信息列表。
    ![Trace Analysis](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/0036677161/p63933.png)


## 查看应用拓扑

应用拓扑主要展示经过条件过滤后的应用间依赖关系的拓扑图，以及各应用之间的请求比例、调用倍数和耗时比例等信息。基于性能体验考虑，应用拓扑最多支持拉取5000条链路请求进行聚合。

1.  单击应用拓扑页签，查看应用拓扑图。

    ![Trace Topology ](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/3750368061/p66600.png)

    **说明：**

    -   请求比例=应用对外调用的请求数/应用总请求数。 例如有100个请求进入上层应用A， 而从A调用下层应用B的只有90个请求，那么A到B的请求比例为90%。（因为在应用A中，可能存在if判断进行过滤，导致一些请求不会进入应用B。）
    -   调用倍数=应用对外调用的Span数/应用总Span数。例如有100个Span进入上层应用A， 而从A调用下层应用B的有300个Span，那么A到B的调用倍数为3。 例如A到B显示为90%/3x， 表示应用A中有90% 的请求会去调用应用B，应用A平均调用3次应用B。

## 查看实时聚合链路表

实时聚合是将经过条件过滤后的调用链，根据Span名称和应用名进行聚合的调用链路表。基于性能体验考虑，实时聚合最多支持拉取5000条链路请求进行聚合。

1.  单击全链路聚合页签，查看实时聚合链路表。

    ![Trace Real-time Aggregation](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/3750368061/p66616.png)

    **说明：**

    -   请求数/请求比例：请求比例表示调用当前Span节点的请求比例数。例如总请求数为100个，请求比例为10% 表示有10个请求调用当前Span。计算公式=当前Span的请求数/总请求数×100%。
    -   Span数/请求倍数：请求倍数表示平均每个请求数调用当前Span的次数，例如1.5x表示平均每个请求会调用当前Span 1.5次 。计算公式=Span数/Span的请求数。
    -   平均自身耗时/比例：平均自身耗时表示不包括子Span的平均耗时，例如Span A到B中，A耗时为10毫秒，B耗时为8毫秒，那么A的自身耗时为2毫秒。计算公式=Span耗时-Sum（子Span耗时）。如果是异步调用的话，将不会减去子耗时，计算公式=Span耗时。
    -   异常数/异常比例：异常比例表示出现异常的请求比例，例如3%表示有3%的请求出现异常。计算公式=异常请求数/总请求数。异常请求数不等于异常数，当请求倍数大于1时，一个异常请求可能对应多个异常数。
2.  将鼠标悬浮于蓝色Span名称上，显示推荐调用链提示信息，可查看与此Span关联的调用链。单击其中一条traceId，显示调用链瀑布图，更多信息，请参见[查看调用链瀑布图](#section_nn0_y6s_g63)。


## 查看调用链瀑布图

1.  单击调用链列表中的某条TraceId，显示调用链瀑布图。

    在调用链路页面上，您可以看到调用链的Span名称、时间轴、应用名、开始时间、IP地址和状态等信息。

    **说明：** **IP地址**字段显示的是IP地址还是机器名称，取决于应用设置页面上的显示配置。更多信息，请参见[管理应用和标签](/cn.zh-CN/控制台操作/应用管理/管理应用和标签.md)。

    ![Page Trace](../images/p63969.png "调用链路页面")

2.  将鼠标悬浮于Span名称上，可以查看该Span的时长、开始时间、Tag和日志事件等信息。

    ![Overlay Tag and Log Events](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/3750368061/p63977.png)


## 设置查询时间范围

您可以选择预设的时间范围，或者输入自定义的时间范围。

-   单击页面右上角的时间选择框，然后单击一个预设的时间范围，例如**最近30分钟**、**今天**、**本周**。
-   如果没有符合需求的预设时间范围，则单击**自定义**，然后在日历中选择起始和截止时间，或者在文本框内手动输入，并单击**确定**。

    **说明：** 日期的格式为`YYYY-MM-DD`，时间的格式为`HH:MM`。


![Time Picker](../images/p53830.png "查询时间范围选择器")

[准备工作概述](/cn.zh-CN/准备工作/准备工作概述.md)

[管理应用和标签](/cn.zh-CN/控制台操作/应用管理/管理应用和标签.md)

